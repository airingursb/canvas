# Ch6 çº¿æ¡çš„å±æ€§

## çº¿æ¡å±æ€§æ¦‚è¿°

çº¿æ¡çš„å±æ€§å…±æœ‰ä»¥ä¸‹å››ä¸ªï¼š

#### 1ã€lineCapå±æ€§

lineCap å®šä¹‰ä¸Šä¸‹æ–‡ä¸­çº¿çš„ç«¯ç‚¹ï¼Œå¯ä»¥æœ‰ä»¥ä¸‹ 3 ä¸ªå€¼ã€‚

* buttï¼šé»˜è®¤å€¼ï¼Œç«¯ç‚¹æ˜¯å‚ç›´äºçº¿æ®µè¾¹ç¼˜çš„å¹³ç›´è¾¹ç¼˜ã€‚
* roundï¼šç«¯ç‚¹æ˜¯åœ¨çº¿æ®µè¾¹ç¼˜å¤„ä»¥çº¿å®½ä¸ºç›´å¾„çš„åŠåœ†ã€‚
* squareï¼šç«¯ç‚¹æ˜¯åœ¨é€‰æ®µè¾¹ç¼˜å¤„ä»¥çº¿å®½ä¸ºé•¿ã€ä»¥ä¸€åŠçº¿å®½ä¸ºå®½çš„çŸ©å½¢ã€‚

#### 2ã€lineJoinå±æ€§

lineJoin å®šä¹‰ä¸¤æ¡çº¿ç›¸äº¤äº§ç”Ÿçš„æ‹è§’ï¼Œå¯å°†å…¶ç§°ä¸ºè¿æ¥ã€‚åœ¨è¿æ¥å¤„åˆ›å»ºä¸€ä¸ªå¡«å……ä¸‰è§’å½¢ï¼Œå¯ä»¥ä½¿ç”¨ lineJoin è®¾ç½®å®ƒçš„åŸºæœ¬å±æ€§ã€‚

* miterï¼šé»˜è®¤å€¼ï¼Œåœ¨è¿æ¥å¤„è¾¹ç¼˜å»¶é•¿ç›¸æ¥ã€‚miterLimit æ˜¯è§’é•¿å’Œçº¿å®½æ‰€å…è®¸çš„æœ€å¤§æ¯”ä¾‹(é»˜è®¤æ˜¯ 10)ã€‚
* bevelï¼šè¿æ¥å¤„æ˜¯ä¸€ä¸ªå¯¹è§’çº¿æ–œè§’ã€‚
* roundï¼šè¿æ¥å¤„æ˜¯ä¸€ä¸ªåœ†ã€‚

#### 3ã€çº¿å®½

lineWidth å®šä¹‰çº¿çš„å®½åº¦(é»˜è®¤å€¼ä¸º 1.0)ã€‚

#### 4ã€ç¬”è§¦æ ·å¼

strokeStyle å®šä¹‰çº¿å’Œå½¢çŠ¶è¾¹æ¡†çš„é¢œè‰²å’Œæ ·å¼ã€‚

åé¢ä¸¤ä¸ªå‰é¢å·²ç»è¯´è¿‡äº†ï¼Œè¿™é‡Œæˆ‘ä»¬ç€é‡æ¥çœ‹çœ‹å‰ä¸¤ä¸ªå±æ€§ã€‚

## çº¿æ¡çš„å¸½å­`lineCap`

åºŸè¯ä¸å¤šè¯´ï¼Œç›´æ¥ä¸Šä»£ç çœ‹æ•ˆæœã€‚

```HTML
<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>çº¿æ¡çš„å¸½å­</title>
</head>
<body>
<div id="canvas-warp">
    <canvas id="canvas" style="border: 1px solid #aaaaaa; display: block; margin: 50px auto;">
        ä½ çš„æµè§ˆå™¨å±…ç„¶ä¸æ”¯æŒCanvasï¼Ÿï¼èµ¶å¿«æ¢ä¸€ä¸ªå§ï¼ï¼
    </canvas>
</div>

<script>
    window.onload = function(){
        var canvas = document.getElementById("canvas");
        canvas.width = 800;
        canvas.height = 600;
        var context = canvas.getContext("2d");

        context.lineWidth = 50;
        context.strokeStyle = "#1BAAAA";

        context.beginPath();
        context.moveTo(100,100);
        context.lineTo(700,100);
        context.lineCap = "butt";
        context.stroke();

        context.beginPath();
        context.moveTo(100,300);
        context.lineTo(700,300);
        context.lineCap = "round";
        context.stroke();

        context.beginPath();
        context.moveTo(100,500);
        context.lineTo(700,500);
        context.lineCap = "square";
        context.stroke();

        //ä¸‹é¢ç”»ä¸¤ä¸ªåŸºå‡†çº¿æ–¹ä¾¿è§‚å¯Ÿ
        context.lineWidth = 3;
        context.strokeStyle = "black";

        context.beginPath();
        context.moveTo(100,0);
        context.lineTo(100,600);
        context.moveTo(700,0);
        context.lineTo(700,600);
        context.stroke();
    }
</script>
</body>
</html>
```

[æ¼”ç¤º 6-1](http://airingursb.github.io/canvas/Canvas/6/6-1.html)

è¿è¡Œç»“æœï¼š

![çº¿æ¡çš„å¸½å­](http://airing.ursb.me/edu6-1.png-html.jpg)

è¿™é‡Œæˆ‘è¿˜åšäº†ä¸¤æ¡å¹³è¡Œçº¿åšä¸€ä¸‹å‚è€ƒï¼Œè¿™æ ·ä¸€çœ¼å°±èƒ½çœ‹æ¸…`lineCap`ä¸‰ä¸ªå€¼çš„ç‰¹ç‚¹ã€‚ä½†è¦æ³¨æ„ï¼Œè¿™ä¸ªå¸½å­åªåœ¨çº¿æ¡çš„ç«¯ç‚¹å¤„èµ·ä½œç”¨ï¼Œå“ªæ€•æ˜¯æŠ˜ç‚¹å¾ˆå¤šçš„æŠ˜çº¿ï¼Œä¹Ÿä»…ä»…æ˜¯åœ¨å¼€å§‹å’Œç»ˆæ­¢çš„ä¸¤ä¸ªç«¯ç‚¹å¸¦å¸½å­ã€‚å¦‚æœæƒ³æ”¹å˜çº¿æ¡æŠ˜ç‚¹(ä¸¤ä¸ªçº¿æ®µçš„è¿æ¥å¤„)çš„æ ·å¼ï¼Œé‚£å°±è¦ç”¨åˆ°ä¸‹é¢çš„`lineJoin`å±æ€§ã€‚

## çº¿æ¡çš„è¿æ¥`lineJoin`

åºŸè¯ä¸å¤šè¯´ï¼Œç›´æ¥ä¸Šä»£ç çœ‹æ•ˆæœã€‚è¿™æ®µä»£ç æ”¹è‡ª4-3ï¼Œåªæ˜¯è®¾ç½®äº†ä¸€ä¸‹è¿æ¥çš„å±æ€§ã€‚

```HTML
<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>çº¿æ¡çš„è¿æ¥</title>
</head>
<body>
<div id="canvas-warp">
    <canvas id="canvas" style="border: 1px solid #aaaaaa; display: block; margin: 50px auto;">
        ä½ çš„æµè§ˆå™¨å±…ç„¶ä¸æ”¯æŒCanvasï¼Ÿï¼èµ¶å¿«æ¢ä¸€ä¸ªå§ï¼ï¼
    </canvas>
</div>

<script>
    window.onload = function(){
        var canvas = document.getElementById("canvas");
        canvas.width = 800;
        canvas.height = 600;
        var context = canvas.getContext("2d");

        context.beginPath();
        context.moveTo(100,100);
        context.lineTo(300,300);
        context.lineTo(100,500);
        context.lineJoin = "miter";
        context.lineWidth = 20;
        context.strokeStyle = "red";
        context.stroke();

        context.beginPath();
        context.moveTo(300,100);
        context.lineTo(500,300);
        context.lineTo(300,500);
        context.lineJoin = "bevel";
        context.lineWidth = 20;
        context.strokeStyle = "blue";
        context.stroke();

        context.beginPath();
        context.moveTo(500,100);
        context.lineTo(700,300);
        context.lineTo(500,500);
        context.lineJoin = "round";
        context.lineWidth = 20;
        context.strokeStyle = "black";
        context.stroke();
    }
</script>
</body>
</html>
```

[æ¼”ç¤º 6-2](http://airingursb.github.io/canvas/Canvas/6/6-2.html)

è¿è¡Œç»“æœï¼š

![çº¿æ¡çš„è¿æ¥](http://airing.ursb.me/edu6-2.png-html.jpg)

çœ‹ä¸æ¸…çš„ç«¥é‹è‡ªå·±æ”¾å¤§ç½‘é¡µæˆ–è€…è‡ªå·±å°†ä»£ç çš„çº¿å®½è°ƒå®½ä¸€ç‚¹ã€‚

è¿™é‡Œæœ‰ä¸€ä¸ªå¾ˆéšè”½çš„å±æ€§ï¼Œå°±æ˜¯å½“`lineJoin`è®¾ç½®ä¸ºmiteræ—¶ï¼ˆé»˜è®¤ï¼‰ï¼Œä¼šè§£é”ä¸€ä¸ªæˆç»©ï¼Œå¯ä»¥ä½¿ç”¨`miterLimit`å±æ€§ã€‚

ä¸¾ä¸ªä¾‹å­çœ‹çœ‹ã€‚

```HTML
<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>miterLimit</title>
</head>
<body>
<div id="canvas-warp">
    <canvas id="canvas" style="border: 1px solid #aaaaaa; display: block; margin: 50px auto;">
        ä½ çš„æµè§ˆå™¨å±…ç„¶ä¸æ”¯æŒCanvasï¼Ÿï¼èµ¶å¿«æ¢ä¸€ä¸ªå§ï¼ï¼
    </canvas>
</div>

<script>
    window.onload = function(){
        var canvas = document.getElementById("canvas");
        canvas.width = 800;
        canvas.height = 600;
        var context = canvas.getContext("2d");

        context.beginPath();
        context.moveTo(100,100);
        context.lineTo(300,300);
        context.lineTo(100,500);
        context.lineJoin = "miter";
        context.miterLimit = 10;
        context.lineWidth = 5;
        context.strokeStyle = "red";
        context.stroke();

        context.beginPath();
        context.moveTo(300,200);
        context.lineTo(500,300);
        context.lineTo(300,400);
        context.lineJoin = "miter";
        context.miterLimit = 10;
        context.lineWidth = 5;
        context.strokeStyle = "blue";
        context.stroke();

        context.beginPath();
        context.moveTo(500,290);
        context.lineTo(700,300);
        context.lineTo(500,310);
        context.lineJoin = "miter";
        context.miterLimit = 10;
        context.lineWidth = 5;
        context.strokeStyle = "black";
        context.stroke();
    }
</script>
</body>
</html>
```

[æ¼”ç¤º 6-3](http://airingursb.github.io/canvas/Canvas/6/6-3.html)

è¿è¡Œç»“æœï¼š

![miterLimit](http://airing.ursb.me/edu6-3.png-html.jpg)

ä¼šå‘ç°ï¼Œè¿™ä¸ª`miterLimit`è§„å®šäº†ä¸€ä¸ªè‡ªåŠ¨å¡«å……è¿æ¥ç‚¹çš„æé™å€¼ã€‚å¦‚æœè¶…è¿‡äº†è¿™ä¸ªå€¼ï¼Œä¼šå¯¼è‡´`lineJoin`å±æ€§å¤±æ•ˆï¼Œä¼šä» miter å˜æˆ bevelã€‚å¯ä»¥çœ‹å‡ºæ¥ï¼Œè¿™ä¸ªå€¼å’Œçº¿å®½ä»¥åŠå¤¹è§’æœ‰å…³ï¼Œå…·ä½“æ˜¯å•¥å…³ç³»ã€‚çœ‹ä¸‹å›¾ã€‚

![miterLimit](http://airing.ursb.me/edu6-4.png)

å¯ä»¥çœ‹åˆ°ï¼Œå…³ç³»æœ‰ç‚¹å¤æ‚ã€‚æœ‰å…´è¶£çš„å°ä¼™ä¼´å¯ä»¥æ¨å¯¼ä¸€ä¸‹è¿™ä¸ªå€¼ä¸çº¿å®½ã€å¤¹è§’çš„å‡½æ•°å…³ç³»ã€‚å…¶å®ï¼Œå¤§å¤šæ—¶å€™ç”¨ä¸åˆ°è¿™ä¸ªéšè—å±æ€§ï¼Œå³ä¾¿ç”¨åˆ°äº†ä¹Ÿæ˜¯å‡­æ„Ÿè§‰å†™ä¸ªæ•°ç„¶åä¸æ»¡æ„å†è°ƒè¯•å³å¯ã€‚

## é«˜çº§çº¿æ®µç»˜åˆ¶ä¸¾ä¾‹

å®é™…åœ¨ç”»å¸ƒä¸Šç»˜åˆ¶çº¿æ®µæ—¶ï¼Œä¼šæœ‰ä¸€äº›å¥‡æ€ªçš„ç°è±¡å‘ç”Ÿï¼Œè¿™é‡Œèåˆæœ¬èŠ‚è¯¾å­¦åˆ°çš„ä¸¤ä¸ªçº¿æ®µçš„å±æ€§è®²è§£ä¸€ä¸ªã€‚

```HTML
<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>miterLimit</title>
</head>
<body>
<div id="canvas-warp">
    <canvas id="canvas" style="border: 1px solid #aaaaaa; display: block; margin: 50px auto;">
        ä½ çš„æµè§ˆå™¨å±…ç„¶ä¸æ”¯æŒCanvasï¼Ÿï¼èµ¶å¿«æ¢ä¸€ä¸ªå§ï¼ï¼
    </canvas>
</div>

<script>
    window.onload = function(){
        var canvas = document.getElementById("canvas");
        canvas.width = 800;
        canvas.height = 600;
        var context = canvas.getContext("2d");

        // å®ä¾‹1: åœ†å½¢ç«¯ç‚¹,æ–œè§’è¿æ¥,åœ¨ç”»å¸ƒå·¦ä¸Šè§’
        context.beginPath();
        context.moveTo(0,0);
        context.lineTo(180,0);
        context.lineTo(180,180);
        context.lineJoin = 'bevel';
        context.lineCap = 'round';
        context.lineWidth = 10;
        context.strokeStyle = "red";
        context.stroke();

        // å®ä¾‹2: åœ†å½¢ç«¯ç‚¹,æ–œè§’è¿æ¥,ä¸åœ¨ç”»å¸ƒå·¦ä¸Šè§’
        context.beginPath();
        context.moveTo(300,200);
        context.lineTo(480,200);
        context.lineTo(480,380);
        context.lineJoin = 'bevel';
        context.lineCap = 'round';
        context.lineWidth = 10;
        context.strokeStyle = "blue";
        context.stroke();

        // å®ä¾‹3: å¹³ç›´ç«¯ç‚¹,åœ†å½¢è¿æ¥,ä¸åœ¨ç”»å¸ƒå·¦ä¸Šè§’
        context.beginPath();
        context.moveTo(600,400);
        context.lineTo(780,400);
        context.lineTo(780,580);
        context.lineJoin = 'round';
        context.lineCap = 'butt';
        context.lineWidth = 10;
        context.strokeStyle = "black";
        context.stroke();
    }
</script>
</body>
</html>
```

[æ¼”ç¤º 6-4](http://airingursb.github.io/canvas/Canvas/6/6-4.html)

è¿è¡Œç»“æœï¼š

![é«˜çº§çº¿æ®µç»˜åˆ¶ä¸¾ä¾‹](http://airing.ursb.me/edu6-5.png-html.jpg)

è¿™ 3 ä¸ªçº¿æ®µå’Œè¿æ¥çš„å®ä¾‹æœ‰åŠ©äºè¯´æ˜åœ¨ç”»å¸ƒä¸Šç»˜åˆ¶çº¿æ®µæ—¶ä¸åŒå±æ€§çš„ç»„åˆã€‚

å®ä¾‹ 1 å°è¯•ä»ç”»å¸ƒå·¦ä¸Šè§’å¼€å§‹ç»˜åˆ¶ï¼Œç»“æœå‘ç”Ÿäº†ä¸€ä¸ªå¥‡æ€ªçš„ç°è±¡ã€‚Canvas è·¯å¾„åœ¨ x è½´å’Œ y è½´æ–¹å‘ä¸Šéƒ½ç»˜åˆ¶åˆ°äº†èµ·ç‚¹çš„å¤–ä¾§ã€‚ç”±äºè¿™ä¸ªåŸå› å®ä¾‹ 1 ä¸Šé¢çš„çº¿çœ‹èµ·æ¥è¦ç»†äº›ã€‚å¦å¤–ï¼Œå·¦ä¸Šè§’æ°´å¹³éƒ¨åˆ†ä¸­åœ†å½¢ç«¯ç‚¹ä¹Ÿæ— æ³•çœ‹åˆ°ï¼Œå®ƒä»¬éƒ½è¢«ç»˜åˆ¶åˆ°äº†å±å¹•ä¹‹å¤–çš„è´Ÿå€¼åæ ‡åŒºåŸŸã€‚æ­¤å¤–ï¼Œ`lineJoin` å®šä¹‰çš„å¯¹è§’çº¿æ–œè§’ä¹Ÿæ²¡æœ‰ç»˜å‡ºã€‚

å®ä¾‹ 2 è°ƒæ•´äº†ä¾‹å­ 1 ä¸­å‡ºç°çš„é—®é¢˜,å°†èµ·å§‹ç‚¹ç¦»å¼€å·¦ä¸Šè§’ã€‚è¿™æ ·å°±ç»˜åˆ¶å‡ºäº†å®Œæ•´çš„æ°´å¹³çº¿,å¹¶ä¸”åœ†å½¢ `lineCap` å’Œæ–œè§’ `lineJoin` éƒ½è¢«ç»˜åˆ¶å‡ºæ¥äº†ã€‚

å®ä¾‹ 3 æ˜¾ç¤ºäº†å»æ‰ `lineCap` è®¾ç½®åçš„é»˜è®¤ç«¯ç‚¹æ•ˆæœ,å¹¶ä¸”å°† `lineJoin` è°ƒæ•´ä¸ºåœ†è§’ã€‚

è‡³æ­¤ï¼Œçº¿æ¡çš„æ‰€æœ‰å†…å®¹æˆ‘ä»¬å·²ç»è¯´å®Œäº†ã€‚è¿™ä¸ªçœ‹èµ·æ¥å¾ˆç®€å•çš„ä¸€ä¸ªçº¿æ¡ï¼ŒåŸæ¥è¿˜æœ‰è¿™ä¹ˆå¤šå†…å®¹ï¼è‰ºæœ¯å®¶å¯ä¸æ˜¯é‚£ä¹ˆå¥½å½“çš„ï¼Œä¸è¿‡æƒ³å¿…ä¹Ÿæ¿€å‘äº†ç«¥é‹ä»¬çš„æ±‚çŸ¥æ¬²ã€‚Canvasç©¶ç«Ÿæœ‰å¤šå°‘å†…å®¹ç­‰å¾…ç€æˆ‘ä»¬å»å‘ç°ï¼Ÿè¿™æ˜¯ä¸€ä¸ªå¼€å§‹ï¼Œè®©æˆ‘ä»¬ç»§ç»­å‰è¡Œï¼ğŸ˜‹